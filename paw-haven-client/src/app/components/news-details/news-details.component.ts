import { CommonModule } from '@angular/common';
import { Component, OnInit } from '@angular/core';
import { ActivatedRoute, Router, RouterLink } from '@angular/router';
import { PawLoaderComponent } from '../shared/paw-loader/paw-loader.component';

interface NewsItem {
  id: number;
  title: string;
  summary: string;
  content: string;
  imageUrl: string;
  date: Date;
  author: string;
  category: string;
}

@Component({
  selector: 'app-news-details',
  standalone: true,
  imports: [CommonModule, RouterLink, PawLoaderComponent],
  templateUrl: './news-details.component.html',
  styleUrl: './news-details.component.scss'
})
export class NewsDetailsComponent implements OnInit {
  newsItem: NewsItem | null = null;
  isLoading = true;
  errorMessage = '';
  relatedNews: NewsItem[] = [];

  constructor(
    private route: ActivatedRoute,
    private router: Router
  ) {}

  ngOnInit(): void {
    this.route.paramMap.subscribe(params => {
      const id = Number(params.get('id'));
      if (isNaN(id)) {
        this.errorMessage = 'Невірний ідентифікатор новини';
        this.isLoading = false;
        return;
      }
      
      // Simulate loading news data
      setTimeout(() => {
        this.loadNewsItem(id);
        this.isLoading = false;
      }, 1000);
    });
  }

  loadNewsItem(id: number): void {
    // Mock data - in a real application, this would come from a service
    const allNews: NewsItem[] = [
      {
        id: 1,
        title: 'Відкриття нового притулку для тварин у Київській області',
        summary: 'Новий притулок здатний прихистити до 200 тварин та обладнаний сучасною ветеринарною клінікою.',
        content: `<p>У Київській області відбулося урочисте відкриття нового сучасного притулку для безпритульних тварин. Заклад, який отримав назву "Щасливі лапки", розташований на території площею 2 гектари та оснащений за найсучаснішими стандартами.</p>
        <p>Притулок розрахований на одночасне утримання до 200 тварин, включаючи собак, котів та дрібних домашніх тварин. На території притулку розташовані:</p>
        <ul>
          <li>Просторі вольєри для собак з утепленими будками</li>
          <li>Окремі приміщення для котів з ігровими зонами</li>
          <li>Сучасна ветеринарна клініка</li>
          <li>Карантинне відділення</li>
          <li>Кухня для приготування їжі для тварин</li>
          <li>Адміністративна будівля</li>
          <li>Навчальний центр для волонтерів</li>
        </ul>
        <p>Особливістю нового притулку є наявність власної ветеринарної клініки, де працюють досвідчені ветеринари, здатні проводити складні операції та надавати повний спектр медичних послуг для тварин. Це дозволить не лише піклуватися про мешканців притулку, але й надавати допомогу іншим тваринам з менш обладнаних закладів.</p>
        <p>Проект був реалізований завдяки спільним зусиллям благодійної організації "Захист тварин України", місцевої влади та численних приватних донорів. Загальна вартість проекту склала близько 15 мільйонів гривень.</p>
        <p>"Ми дуже пишаємося цим досягненням. Наш притулок - це не просто місце тимчасового перебування безпритульних тварин, а справжній дім, де вони отримують любов, турботу та шанс знайти нову родину", - зазначила директорка притулку Олена Мельник.</p>
        <p>Вже у перший день роботи притулок прийняв 50 тварин, врятованих з вулиць міста. Усі вони пройшли обстеження, отримали необхідне лікування та будуть підготовлені до прилаштування в нові родини.</p>
        <p>Якщо ви бажаєте допомогти притулку або взяти тварину з нього, ви можете відвідати заклад щодня з 10:00 до 18:00 або зв'язатися з адміністрацією за телефоном: 000-000-0000.</p>`,
        imageUrl: 'assets/images/news/shelter.jpeg',
        date: new Date('2025-04-10'),
        author: 'Анна Коваленко',
        category: 'Новини'
      },
      {
        id: 2,
        title: 'Допоможіть врятувати цуценят, знайдених у коробці біля дороги',
        summary: 'П\'ятеро цуценят терміново потребують фінансової допомоги для лікування та тимчасової перетримки.',
        content: `<p>Учора ввечері на околиці міста біля траси волонтери знайшли картонну коробку, в якій знаходилося п'ятеро маленьких цуценят віком приблизно 1-1,5 місяці. Тварини були в жахливому стані: виснажені, знесилені від спеки та спраги, заражені паразитами.</p>
        <p>Волонтери негайно доставили цуценят до ветеринарної клініки, де їм надали першу допомогу. За попередніми оцінками ветеринарів, усі цуценята мають:</p>
        <ul>
          <li>Серйозне зневоднення</li>
          <li>Інфестацію блохами та кліщами</li>
          <li>Кишкові паразити</li>
          <li>Одне цуценя має ознаки пневмонії</li>
        </ul>
        <p>Наразі тварини перебувають на стаціонарному лікуванні. Їм потрібні медикаменти, спеціальне харчування та подальша тимчасова перетримка до моменту прилаштування в постійні домівки.</p>
        <p>Ми терміново збираємо кошти на лікування та утримання цих малюків. За попередніми підрахунками, на лікування всіх п'яти цуценят потрібно близько 15 000 гривень.</p>
        <p>Також ми шукаємо тимчасові домівки для цуценят після одужання - потрібні відповідальні люди, які могли б взяти на перетримку одного або кількох цуценят на період 1-2 місяці, поки ми шукатимемо для них постійні родини.</p>
        <p>Ви можете допомогти, перерахувавши будь-яку суму на картку волонтера: 0000 0000 0000 0000 (Приватбанк, Михайло Петренко).</p>
        <p>Якщо ви готові взяти цуценя на перетримку або назавжди, зателефонуйте за номером: 000-000-0000.</p>
        <p>Дякуємо за вашу підтримку! Разом ми зможемо врятувати ці маленькі життя!</p>`,
        imageUrl: 'assets/images/news/dog.jpeg',
        date: new Date('2025-04-08'),
        author: 'Михайло Петренко',
        category: 'Оголошення'
      },
      {
        id: 3,
        title: 'Як правильно адаптувати кота до нового дому: поради ветеринара',
        summary: 'Професійні рекомендації, які допоможуть вашому новому улюбленцю швидше звикнути до нового оточення.',
        content: `<p>Переїзд на нове місце – це значний стрес для кота, особливо якщо йдеться про безпритульну тварину або кота з притулку. Правильна адаптація – запорука психологічного та фізичного благополуччя вашого нового улюбленця. У цій статті ми поділимося професійними порадами, які допоможуть зробити цей процес максимально комфортним.</p>
        <h3>1. Підготуйте будинок заздалегідь</h3>
        <p>Перш ніж привести кота додому, переконайтеся, що у вас є все необхідне:</p>
        <ul>
          <li>Туалетний лоток з наповнювачем</li>
          <li>Миски для їжі та води</li>
          <li>Якісний корм (бажано той, яким кота годували раніше)</li>
          <li>Місце для відпочинку (лежанка, будиночок)</li>
          <li>Кігтеточка</li>
          <li>Іграшки</li>
          <li>Переноска</li>
        </ul>
        <h3>2. Виділіть "безпечну зону"</h3>
        <p>На початковому етапі адаптації варто обмежити простір для кота однією кімнатою. Це має бути тихе місце, де кіт зможе сховатися та відчути себе в безпеці. Розмістіть тут лоток, їжу, воду та лежанку. Поступово, коли кіт звикне, можна відкривати доступ до інших кімнат.</p>
        <h3>3. Перші години в новому будинку</h3>
        <p>Принісши кота додому, не намагайтеся одразу витягнути його з переноски. Відкрийте дверцята та дайте йому можливість вийти самостійно, коли він буде готовий. Не нав'язуйте спілкування, дайте тварині час на освоєння території.</p>
        <h3>4. Режим харчування</h3>
        <p>Спочатку намагайтеся годувати кота тим кормом, який він отримував раніше, щоб уникнути додаткового стресу та проблем з травленням. Якщо ви плануєте змінити раціон, робіть це поступово, протягом 7-10 днів, щодня збільшуючи частку нового корму.</p>
        <h3>5. Спілкування та ігри</h3>
        <p>Встановлюйте контакт з котом поступово. Дозвольте йому підійти до вас першим. Розмовляйте спокійним, тихим голосом. Використовуйте іграшки для налагодження зв'язку – гра допомагає знизити стрес та встановити довірливі стосунки.</p>
        <h3>6. Перше відвідування ветеринара</h3>
        <p>Протягом перших 7-10 днів після появи кота в будинку варто показати його ветеринару для огляду, особливо якщо йдеться про колишнього безпритульного кота. Лікар перевірить загальний стан здоров'я, наявність паразитів, порекомендує вакцинацію та стерилізацію/кастрацію (якщо це не було зроблено раніше).</p>
        <h3>7. Терпіння та розуміння</h3>
        <p>Пам'ятайте, що адаптація – процес індивідуальний. Одні коти освоюються за кілька днів, іншим потрібні тижні чи навіть місяці. Особливо це стосується тварин, які мали травматичний досвід або тривалий час жили на вулиці. Будьте терплячими та уважними до потреб вашого улюбленця.</p>
        <p>Якщо у вашого кота спостерігаються тривалі ознаки стресу (відмова від їжі більше 24 годин, агресія, тривала апатія, порушення звичок туалету), обов'язково проконсультуйтеся з ветеринаром.</p>
        <p>Дотримуючись цих рекомендацій, ви зможете допомогти своєму новому улюбленцю швидше адаптуватися та відчути себе як вдома. Пам'ятайте, що ваша любов, терпіння та розуміння – найкращі помічники в цьому процесі.</p>`,
        imageUrl: 'assets/images/news/cat.jpeg',
        date: new Date('2025-04-05'),
        author: 'Дарина Ковальчук',
        category: 'Поради'
      },
      {
        id: 4,
        title: 'Історія Барні: від вуличного пса до службового собаки',
        summary: 'Неймовірна історія перетворення безпритульного собаки на професійного рятувальника.',
        content: `<p>Три роки тому Барні був звичайним безпритульним собакою. Його знайшли волонтери під мостом у промисловій зоні міста – виснаженого, з пораненою лапою та надзвичайно наляканого. Ніхто не міг передбачити, що цей нещасний пес стане одним із найкращих службових собак рятувальної служби.</p>
        <h3>Початок нового життя</h3>
        <p>Андрій Ковальчук, кінолог рятувальної служби ДСНС, не планував брати нового собаку. Того дня він просто приїхав до притулку, щоб передати корм у якості благодійної допомоги. Проходячи повз вольєрів, він звернув увагу на невеликого чорно-білого пса, який не гавкав, як інші, а уважно спостерігав за ним.</p>
        <p>"У нього був особливий погляд – розумний, зосереджений. Я попросив волонтерів розповісти про нього і дізнався його історію. Щось підказувало мені, що цей пес має потенціал", - згадує Андрій.</p>
        <p>Кінолог вирішив взяти Барні на тимчасову перетримку, щоб оцінити його здібності та можливість навчання. До його здивування, собака продемонстрував неймовірну кмітливість, врівноважений характер та бажання вчитися.</p>
        <h3>Шлях до професійної служби</h3>
        <p>Тренування Барні почалося з базових команд. Андрій швидко виявив, що пес має феноменальний нюх та надзвичайну витривалість – найважливіші якості для пошуково-рятувальної собаки.</p>
        <p>Протягом наступних шести місяців Барні пройшов інтенсивну підготовку:</p>
        <ul>
          <li>Навчання пошуку людей під завалами</li>
          <li>Тренування в умовах шуму та диму</li>
          <li>Пошук у лісі</li>
          <li>Робота на воді</li>
          <li>Спускання та підйом на висотні об'єкти</li>
        </ul>
        <p>Пес проявляв неймовірну зосередженість під час тренувань. "Здавалося, що він намагається віддячити за порятунок, працюючи на межі своїх можливостей", - розповідає Андрій.</p>
        <h3>Перше справжнє випробування</h3>
        <p>Перший реальний виклик для Барні стався ще до його офіційної сертифікації. Пізньої осені в горах зникла група туристів із трьох осіб. Пошуки тривали вже добу, і було вирішено залучити додаткові сили, включаючи Барні та Андрія.</p>
        <p>Територія пошуку була складною: гірський рельєф, густа рослинність, сильний вітер, що ускладнював роботу. Барні працював пліч-о-пліч із досвідченими службовими собаками.</p>
        <p>"Саме Барні першим виявив слід і привів нас до ущелини, де знаходилась одна з туристок із травмою ноги. Інші собаки потім допомогли знайти двох інших членів групи, які пішли за допомогою, але заблукали", - згадує Андрій.</p>
        <p>Після цього випадку Барні офіційно пройшов сертифікацію та став повноправним членом кінологічної команди ДСНС.</p>
        <h3>Сьогодення рятувальника Барні</h3>
        <p>За три роки служби Барні взяв участь у понад 40 пошуково-рятувальних операціях. На його рахунку:</p>
        <ul>
          <li>15 знайдених під завалами людей</li>
          <li>23 знайдені в лісі особи</li>
          <li>5 врятованих після сходження лавини</li>
        </ul>
        <p>Барні отримав спеціальну нагороду від керівництва ДСНС "За відвагу у рятувальних операціях" – перший випадок в історії служби, коли таку нагороду отримав колишній безпритульний пес.</p>
        <p>"Історія Барні – це історія про другий шанс. Вона доводить, що часто безпритульні тварини мають неймовірний потенціал, який ми просто не помічаємо. Це також історія про відданість – Барні щодня демонструє вдячність за порятунок, рятуючи інших", - підсумовує Андрій.</p>
        <p>Сьогодні Барні не лише рятує людей, але й допомагає популяризувати ідею прилаштування безпритульних тварин. ДСНС спільно з місцевими притулками проводить акції, під час яких розповідає історію Барні, надихаючи людей давати другий шанс чотирилапим друзям.</p>`,
        imageUrl: 'assets/images/news/dogs.jpeg',
        date: new Date('2025-04-02'),
        author: 'Олег Вишневський',
        category: 'Історії'
      },
      {
        id: 5,
        title: 'Нові законодавчі зміни щодо захисту тварин в Україні',
        summary: 'Верховна Рада ухвалила нові закони, які посилюють відповідальність за жорстоке поводження з тваринами.',
        content: `<p>Верховна Рада України ухвалила у другому читанні та в цілому законопроект №1234 "Про внесення змін до деяких законодавчих актів України щодо посилення відповідальності за жорстоке поводження з тваринами". Цей документ значно підвищує штрафи та посилює кримінальну відповідальність за злочини проти тварин.</p>
        <h3>Основні зміни у законодавстві:</h3>
        <h4>1. Збільшення штрафів</h4>
        <p>Адміністративна відповідальність за жорстоке поводження з тваринами тепер передбачає штрафи:</p>
        <ul>
          <li>Для громадян - від 3400 до 5100 гривень (раніше від 1700 до 3400 гривень)</li>
          <li>Для посадових осіб - від 5100 до 8500 гривень (раніше від 3400 до 5100 гривень)</li>
        </ul>
        <p>За ті самі дії, вчинені протягом року після накладення адміністративного стягнення:</p>
        <ul>
          <li>Для громадян - від 5100 до 8500 гривень</li>
          <li>Для посадових осіб - від 8500 до 11900 гривень</li>
        </ul>
        <h4>2. Посилення кримінальної відповідальності</h4>
        <p>Кримінальний кодекс доповнено новими статтями, що передбачають:</p>
        <ul>
          <li>За жорстоке поводження з тваринами, що спричинило їх тяжке травмування або загибель - арешт на строк до 6 місяців або обмеження волі на строк до 3 років</li>
          <li>За ті самі дії, вчинені з особливою жорстокістю, або у присутності малолітньої чи неповнолітньої особи, або щодо двох і більше тварин - обмеження волі на строк від 3 до 5 років або позбавлення волі на строк від 3 до 5 років</li>
          <li>За жорстоке поводження з тваринами, вчинене з хуліганських або корисливих мотивів, або з застосуванням садистських методів, або організованою групою - позбавлення волі на строк від 5 до 8 років</li>
        </ul>
        <h4>3. Заборона евтаназії безпритульних тварин</h4>
        <p>Новий закон забороняє масову евтаназію безпритульних тварин як метод регулювання їх чисельності. Єдиним гуманним методом контролю популяції безпритульних тварин визнано стерилізацію з подальшим поверненням у середовище проживання або прилаштуванням.</p>
        <h4>4. Обов'язкова реєстрація та ідентифікація тварин</h4>
        <p>Закон запроваджує обов'язкову реєстрацію та ідентифікацію домашніх тварин (чіпування або інші методи маркування). Це дозволить контролювати кількість домашніх тварин, запобігати їх безвідповідальному викиданню на вулицю та притягувати до відповідальності власників, які порушують правила утримання тварин.</p>
        <h4>5. Заборона використання тварин у цирках</h4>
        <p>Вводиться заборона на використання диких тварин у циркових виставах та інших розважальних заходах. Цирки, які вже мають тварин, зобов'язані протягом двох років забезпечити їм належні умови утримання або передати їх до зоопарків чи реабілітаційних центрів.</p>
        <h3>Механізми реалізації закону</h3>
        <p>Для ефективної реалізації нового закону передбачено:</p>
        <ul>
          <li>Створення єдиної електронної бази обліку домашніх та безпритульних тварин</li>
          <li>Збільшення фінансування програм стерилізації безпритульних тварин</li>
          <li>Підтримка створення та функціонування притулків для тварин</li>
          <li>Розвиток інституту муніципальної варти, яка контролюватиме дотримання правил утримання тварин</li>
        </ul>
        <p>Міністр захисту довкілля та природних ресурсів зазначив: "Прийняття цього закону - важливий крок до формування гуманного суспільства. Ми нарешті маємо ефективні механізми для захисту прав тварин та запобігання їх жорстокому використанню. Наступним етапом буде розробка та затвердження підзаконних актів, які дозволять повноцінно реалізувати всі положення закону".</p>
        <p>Закон набуде чинності через три місяці з дня його опублікування, щоб дати час органам місцевого самоврядування, правоохоронним органам та власникам тварин підготуватися до нових вимог.</p>
        <p>Зоозахисники вже назвали цей закон "революційним" для України та висловили надію, що він дійсно змінить ситуацію із захистом прав тварин у країні.</p>`,
        imageUrl: 'assets/images/news/love.jpeg',
        date: new Date('2025-03-28'),
        author: 'Юлія Захарченко',
        category: 'Новини'
      },
      {
        id: 6,
        title: 'Благодійний марафон "Біжу за тварин" відбудеться цієї неділі',
        summary: 'Приєднуйтесь до благодійного забігу, щоб зібрати кошти для безпритульних тварин.',
        content: `<p>Цієї неділі, 18 квітня, у центральному парку міста відбудеться благодійний марафон "Біжу за тварин". Захід організовано ГО "Захист тварин" спільно з міською радою та місцевими бізнесами з метою збору коштів для місцевих притулків для безпритульних тварин.</p>
        <h3>Програма заходу</h3>
        <p>Марафон пропонує різні дистанції для учасників будь-якого рівня підготовки:</p>
        <ul>
          <li>Забіг на 2 км (дитячий, сімейний)</li>
          <li>Забіг на 5 км</li>
          <li>Забіг на 10 км</li>
          <li>Напівмарафон 21 км (для досвідчених бігунів)</li>
        </ul>
        <p>Особливістю заходу є те, що учасники можуть бігти разом зі своїми собаками (на дистанціях 2 та 5 км). Організатори підготували спеціальні нагороди для найшвидших "собако-людських" команд.</p>
        <h3>Розклад заходу:</h3>
        <ul>
          <li>8:00 - Початок реєстрації учасників</li>
          <li>9:30 - Відкриття заходу, привітання організаторів</li>
          <li>10:00 - Старт напівмарафону (21 км)</li>
          <li>10:30 - Старт забігу на 10 км</li>
          <li>11:00 - Старт забігу на 5 км</li>
          <li>11:30 - Старт забігу на 2 км</li>
          <li>13:30 - Нагородження переможців</li>
          <li>14:00-18:00 - Фестиваль з розважальною програмою</li>
        </ul>
        <h3>Фестивальна програма</h3>
        <p>Після завершення забігів на учасників та гостей чекає насичена програма, яка включає:</p>
        <ul>
          <li>Презентацію притулків для тварин з можливістю взяти тварину додому</li>
          <li>Ветеринарні консультації</li>
          <li>Майстер-класи з догляду за тваринами</li>
          <li>Показові виступи кінологів</li>
          <li>Фуд-корт з вегетаріанськими та веганськими опціями</li>
          <li>Концерт місцевих музичних гуртів</li>
          <li>Дитяча розважальна зона</li>
        </ul>
        <h3>Як взяти участь</h3>
        <p>Для участі в марафоні необхідно зареєструватися на офіційному сайті заходу <a href="http://run4animals.ua">run4animals.ua</a> та сплатити благодійний внесок:</p>
        <ul>
          <li>Забіг на 2 км - 200 грн</li>
          <li>Забіг на 5 км - 300 грн</li>
          <li>Забіг на 10 км - 400 грн</li>
          <li>Напівмарафон - 500 грн</li>
        </ul>
        <p>Усі зібрані кошти будуть спрямовані на потреби місцевих притулків для тварин: закупівлю кормів, медикаментів, ремонт вольєрів та покращення умов утримання тварин.</p>
        <p>Кожен учасник отримає стартовий пакет, який включає:</p>
        <ul>
          <li>Футболку з логотипом заходу</li>
          <li>Стартовий номер</li>
          <li>Чіп для фіксації результату</li>
          <li>Пакет із подарунками від спонсорів</li>
          <li>Медаль фінішера</li>
        </ul>
        <h3>Додаткова інформація</h3>
        <p>Для учасників із собаками необхідно мати при собі ветеринарний паспорт з відмітками про щеплення та намордник (для собак середніх та великих порід).</p>
        <p>На маршруті забігу будуть облаштовані пункти води для людей і тварин, а також чергуватимуть ветеринари та медичні працівники.</p>
        <p>У разі несприятливих погодних умов дата проведення заходу може бути змінена. Слідкуйте за оновленнями на офіційній сторінці заходу.</p>
        <p>Долучайтеся до марафону "Біжу за тварин" - змінюйте життя чотирилапих друзів на краще!</p>
        <p>За додатковою інформацією звертайтеся за телефоном: 000-000-0000 або електронною поштою: info@run4animals.ua</p>`,
        imageUrl: 'assets/images/news/meet.jpeg',
        date: new Date('2025-03-25'),
        author: 'Сергій Лисенко',
        category: 'Оголошення'
      }
    ];

    this.newsItem = allNews.find(news => news.id === id) || null;
    
    if (!this.newsItem) {
      this.errorMessage = 'Новину не знайдено';
      return;
    }
    
    // Get related news from the same category excluding current article
    this.relatedNews = allNews
      .filter(news => news.category === this.newsItem?.category && news.id !== id)
      .slice(0, 3);
  }

  formatDate(date: Date): string {
    const options: Intl.DateTimeFormatOptions = { 
      day: 'numeric', 
      month: 'long', 
      year: 'numeric' 
    };
    return date.toLocaleDateString('uk-UA', options);
  }

  navigateBack(): void {
    this.router.navigate(['/news']);
  }
}